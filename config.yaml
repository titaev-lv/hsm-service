server:
  port: "8443"
  tls:
    ca_path: /app/pki/ca/ca.crt
    cert_path: /app/pki/server/hsm-service.local.crt
    key_path: /app/pki/server/hsm-service.local.key

hsm:
  pkcs11_lib: /usr/lib/softhsm/libsofthsm2.so
  slot_id: hsm-token
  metadata_file: /app/metadata.yaml  # Dynamic rotation metadata
  max_versions: 3  # Maximum key versions to keep
  cleanup_after_days: 30  # Auto-delete versions older than N days
  keys:
    exchange-key:
      type: aes
    2fa:
      type: aes

acl:
  revoked_file: /app/pki/revoked.yaml
  mappings:
    Trading:
      - exchange-key
    2FA:
      - 2fa
    Database: []

rate_limit:
  requests_per_second: 100
  burst: 50

logging:
  level: info
  format: json
